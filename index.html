<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Macnab 2025 Financial Matrix</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f4f6f8; }
    h1, h2 { margin-bottom: 10px; }
    fieldset { border: 1px solid #ccc; margin-bottom: 20px; padding: 15px; background: #fff; }
    legend { font-weight: bold; }
    .input-grid {
      display: grid;
      grid-template-columns: 250px 150px 250px;
      row-gap: 10px;
      column-gap: 10px;
      align-items: center;
    }
    input[type="number"], input[type="range"] {
      width: 100%;
      padding: 5px;
      box-sizing: border-box;
    }
    .summary {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      margin-top: 20px;
    }
    .card {
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      text-align: center;
    }
    .income { color: green; }
    .cost { color: red; }
    .profit-positive { color: green; font-weight: bold; }
    .profit-negative { color: red; font-weight: bold; }
    .auto-toggle { font-size: 0.85em; text-align: right; color: #555; }
  </style>
</head>
<body>
  <h1>Macnab 2025 Financial Matrix</h1>

  <fieldset>
    <legend>Fixed Costs</legend>
    <div class="input-grid">
      <label>Venue Hire (£):</label> <input type="number" id="venueHire" value="300" min="0"><span></span>
      <label>Comedian (£):</label> <input type="number" id="comedian" value="350" min="0"><span></span>
    </div>
  </fieldset>

  <fieldset>
    <legend>Variable Costs</legend>
    <div class="input-grid">
      <label>Base Attendance:</label>
      <input type="number" id="attendanceInput" value="127" min="0"><span></span>

      <label>Masonic %:</label>
      <input type="range" id="masonicPercent" value="50" min="0" max="100" oninput="updateCalculations()">
      <span><span id="masonicLabel">50%</span> (<span id="masonicGuests">0</span> M, <span id="nonMasonicGuests">0</span> NM)</span>

      <label>Wine Bottles (used):</label>
      <input type="number" id="wineBottlesInput" value="90" min="0"><span></span>

      <label>Complimentary Masonic Tickets:</label>
      <input type="number" id="compMasonic" value="6" min="0"><span></span>

      <label>Complimentary Non-Masonic Tickets:</label>
      <input type="number" id="compNonMasonic" value="4" min="0"><span></span>

      <label>Charity Contribution (£):</label>
      <input type="number" id="charityInput" value="0" min="0"><span></span>
    </div>
  </fieldset>

  <fieldset>
    <legend>Projected Income</legend>
    <div class="input-grid">
      <label>Raffle Income (£): <small>£5 per strip</small></label>
      <input type="number" id="raffleIncome" value="820" min="0"><span id="raffleCount"></span>

      <label>Fish Race Income (£): <small>£5 per ticket</small></label>
      <input type="number" id="fishRaceIncome" value="895" min="0"><span id="fishRaceCount"></span>

      <label>Bottle Comp Income (£): <small>£1 per go</small></label>
      <input type="number" id="bottleCompIncome" value="140" min="0"><span id="bottleCompCount"></span>

      <label>Card Transactions (%):</label>
      <input type="range" id="cardTransactions" value="40" min="0" max="100" oninput="updateCalculations()"><span id="cardLabel">40%</span>
    </div>
  </fieldset>

  <fieldset>
    <legend>Spend per Head Breakdown</legend>
    <div class="input-grid">
      <label>Raffle Tickets per Person:</label>
      <input type="number" id="rafflePerPerson" value="0" min="0" step="0.01">
      <span>× £5 = <span id="rafflePerPersonValue">£0.00</span></span>
      <span class="auto-toggle"><label><input type="checkbox" id="raffleAuto" checked> Auto</label></span>

      <label>Fish Race Tickets per Person:</label>
      <input type="number" id="fishRacePerPerson" value="0" min="0" step="0.01">
      <span>× £5 = <span id="fishRacePerPersonValue">£0.00</span></span>
      <span class="auto-toggle"><label><input type="checkbox" id="fishRaceAuto" checked> Auto</label></span>

      <label>Bottle Comp Goes per Person:</label>
      <input type="number" id="bottleCompPerPerson" value="0" min="0" step="0.01">
      <span>× £1 = <span id="bottleCompPerPersonValue">£0.00</span></span>
      <span class="auto-toggle"><label><input type="checkbox" id="bottleCompAuto" checked> Auto</label></span>
    </div>
  </fieldset>

  <h2>Summary</h2>
  <div class="summary">
    <div class="card">Attendance: <span id="summaryAttendance"></span></div>
    <div class="card">Gross Revenue: <span id="summaryGrossRevenue"></span></div>
    <div class="card">Net Revenue: <span id="summaryNetRevenue"></span></div>
    <div class="card">Approx. Spend per Head: <span id="summarySpendPerHead"></span></div>
  </div>

  <script>
    function formatCurrency(v){return new Intl.NumberFormat('en-GB',{style:'currency',currency:'GBP'}).format(v||0);}

    function updateCalculations(){
      const rafflePrice=5, fishPrice=5, bottlePrice=1;
      const attendance = parseFloat(document.getElementById('attendanceInput').value)||0;
      const raffleIncome = parseFloat(document.getElementById('raffleIncome').value)||0;
      const fishIncome = parseFloat(document.getElementById('fishRaceIncome').value)||0;
      const bottleIncome = parseFloat(document.getElementById('bottleCompIncome').value)||0;

      // Update counts
      document.getElementById('raffleCount').textContent = `(${(raffleIncome/rafflePrice).toFixed(0)} strips)`;
      document.getElementById('fishRaceCount').textContent = `(${(fishIncome/fishPrice).toFixed(0)} tickets)`;
      document.getElementById('bottleCompCount').textContent = `(${(bottleIncome/bottlePrice).toFixed(0)} goes)`;

      // Auto per-head logic
      if(document.getElementById('raffleAuto').checked && attendance>0)
        document.getElementById('rafflePerPerson').value = (raffleIncome/rafflePrice/attendance).toFixed(2);
      if(document.getElementById('fishRaceAuto').checked && attendance>0)
        document.getElementById('fishRacePerPerson').value = (fishIncome/fishPrice/attendance).toFixed(2);
      if(document.getElementById('bottleCompAuto').checked && attendance>0)
        document.getElementById('bottleCompPerPerson').value = (bottleIncome/bottlePrice/attendance).toFixed(2);

      const rPP = parseFloat(document.getElementById('rafflePerPerson').value)||0;
      const fPP = parseFloat(document.getElementById('fishRacePerPerson').value)||0;
      const bPP = parseFloat(document.getElementById('bottleCompPerPerson').value)||0;

      document.getElementById('rafflePerPersonValue').textContent=formatCurrency(rPP*rafflePrice);
      document.getElementById('fishRacePerPersonValue').textContent=formatCurrency(fPP*fishPrice);
      document.getElementById('bottleCompPerPersonValue').textContent=formatCurrency(bPP*bottlePrice);

      const sph = (rPP*rafflePrice)+(fPP*fishPrice)+(bPP*bottlePrice);
      document.getElementById('summarySpendPerHead').textContent=formatCurrency(sph);

      document.getElementById('summaryAttendance').textContent=attendance;
      const gross = raffleIncome + fishIncome + bottleIncome;
      document.getElementById('summaryGrossRevenue').textContent=formatCurrency(gross);
      document.getElementById('summaryNetRevenue').textContent=formatCurrency(gross);
    }

    // trigger recalculation when relevant fields change
    ['raffleIncome','fishRaceIncome','bottleCompIncome','attendanceInput',
     'raffleAuto','fishRaceAuto','bottleCompAuto',
     'rafflePerPerson','fishRacePerPerson','bottleCompPerPerson']
      .forEach(id=>document.getElementById(id).addEventListener('input',updateCalculations));

    updateCalculations();
  </script>
</body>
</html>
